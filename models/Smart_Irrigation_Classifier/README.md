# Smart Irrigation Classifier

## Overview

This component contains a trained CatBoost classifier that predicts whether irrigation is needed based on soil, weather, and crop features. The model is intended for programmatic inference inside the project pipeline or as part of the Smart Irrigation service.

## Repository files

- `catboost_model.pkl` — Trained CatBoost model file (stored with Git LFS). Do not edit this file directly.
- `train_model.py` — Training script: data loading, preprocessing, model training, and export. Review this script to reproduce training and to learn the exact feature engineering steps.
- `README.md` — This file: professional usage and developer notes.

## Requirements

- Python 3.8+
- See repository `requirements.txt` for pinned package versions. Key libraries include:
  - catboost
  - pandas
  - scikit-learn
  - joblib
- Git LFS is required to fetch the `*.pkl` objects when cloning the repository. Install via your package manager and run `git lfs install`.

## Quick install

Create a virtual environment and install dependencies:

```powershell
python -m venv .venv
.\.venv\Scripts\Activate.ps1
pip install -r requirements.txt
```

## Usage (inference)

1. Load the model using `joblib` or CatBoost loader:

```python
import joblib
import pandas as pd

# load
model = joblib.load('models/Smart_Irrigation_Classifier/catboost_model.pkl')

# prepare a sample (replace feature names with the exact names used in training)
sample = pd.DataFrame([{
    'soil_moisture': 0.23,
    'temperature': 28.5,
    'humidity': 60.0,
    'rainfall': 0.0,
    'crop_type': 'wheat'
}])

# If you used a preprocessing pipeline when training, run the same pipeline here
pred = model.predict(sample)
prob = model.predict_proba(sample) if hasattr(model, 'predict_proba') else None
print('prediction:', pred)
print('probabilities:', prob)
```

## Input schema

The exact input feature names and types are defined in `train_model.py`. Typical features include (example):

- `soil_moisture` — float (volumetric water content)
- `temperature` — float (°C)
- `humidity` — float (%)
- `rainfall` — float (mm)
- `crop_type` — categorical (string)

Important: categorical features must be encoded the same way as in the training pipeline. If `train_model.py` saves encoders or a preprocessing pipeline, load and reuse them at inference time.

## Model provenance and versioning

- The model binary is tracked with Git LFS. After cloning the repo run `git lfs pull` to retrieve binaries.
- If you retrain the model, increment the model version (tag or commit message) and store the new artifact with LFS.

## Reproducing training

To retrain the model from data:

1. Inspect the original dataset used (check `train_model.py` for the data path under `data/`).
2. Run the training script. Example:

```powershell
python models/Smart_Irrigation_Classifier/train_model.py --output models/Smart_Irrigation_Classifier/catboost_model.pkl
```

3. Validate model performance on a held-out test set and compare metrics with the original model.

## Publishing a new model

When committing a new `*.pkl` model file, Git LFS will manage the large object. Standard workflow:

```powershell
git add models/Smart_Irrigation_Classifier/catboost_model.pkl
git commit -m "chore(model): update smart-irrigation catboost model to vX.Y"
git push origin main
```

## Troubleshooting

- If `joblib.load` fails, check library versions (CatBoost/joblib). Try using the same environment used for training.
- If you see unexpected predictions, verify preprocessing: missing features, different encodings, or scaling changes will affect outputs.
- If `git lfs` objects are missing after clone, run `git lfs pull`.

## Contributing

- Keep model artifacts in `models/` and version changes with clear commit messages.
- Keep training code deterministic where possible (set random seeds) and log parameters/hyperparameters.

## Contact

For questions about the model, dataset, or training pipeline, see `models/Smart_Irrigation_Classifier/train_model.py` or contact the project maintainer.

## See also

- `docs/SMART_IRRIGATION_CLASSIFIER.md` — extended documentation and examples.

